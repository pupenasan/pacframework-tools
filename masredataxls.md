# Файл masterdata.xlsx

Файл  `masterdata.xlsx` призначений для заповнення даних для проекту у формі таблиці. Він містить наступні листи:

- `tags` - перелік технологічних змінних, їх прив'язки до каналів, налаштування каналів, прив'язки до ВМ, налаштування ВМ та ін
- `acttps` - містить шаблон означення ВМ
- `clsid` - містить номера CLSID для поіменованих в таблиці типів 
- 

Файл парситься скриптами і за ним формуються файли JSON та за необхідності документ в CouchDB.

Приклад формату файлу наведений [за посиланням](https://docs.google.com/spreadsheets/d/1GvttNOH74X2o9y0fh_qxQCHhfdFszx7m/edit?usp=sharing&ouid=111751208742846482260&rtpof=true&sd=true) 

## tags

Даний лист містить перелік технологічних змінних та всіх налаштувань асоційованих до них каналів та ВМ.

Таблиця може містити додаткові поля, це ніяк не вплине на роботу скриптів. Деякі з наведених полів можуть бути не задіяні в скрипті. 

Зв'язка `технологічна змінна <-> канал` є проектною за замовченням і може бути зміненою під час налагодження в самому ПЛК. Каркас передбачає, що у будь який момент часу прив'язку змінної до каналу за замовченням можна повернути. 

Якщо канал в проекті резервний, необхідно створювати технологічні змінні з назвами типу `REZDI1`, як це описано в [правилах найменування змінних в каркасі](https://github.com/pupenasan/PACFramework/blob/master/base/1_5_naming.md). Таким чином в листі буде весь бюджет каналів, що дозволить простіше вносити зміни в програму. 

### Загальні поля

`Note` - будь які примітки (не обов'язкове) . Сюди рекомендується писати робочі нотатки, зокрема які відбулися зміни і ким, питання до розробника і т.п.  

`PLACE` - розміщення на схемі або схемах (не обов'язкове)

### Поля для технологічної змінної

`ID` - унікальний ідентифікатор технологічної змінної. Рекомендується давати в діпазонах, наприклад: 1...4999 - AI/NAI, 5000...5999 - AO/NAO, 10001...19999 - DI/NDI, 20000..29999 - DO/NDO   	

`TAGNAME` - унікальне ім'я технологічної змінної

`DESCRIPTION` - опис технологічної змінної	

`TYPE` - тип: AI, DI, AO, DO, NAI, NAO, NDI, NDO 	

`CHID` - ідентифікатор каналу за замовченням

`UNIT` - інженерні одиниці (не обов'язкове)	

`FRMT` - формат відображення (не обов'язкове)		

`SCALE`- масштаб (не обов'язкове), задається у форматі `(min..max)` , наприклад `(0..100)`		

`ALTNAME`	

### Поля для каналу

`SRCADR` - адреса змінної каналу в ПЛК, використовується для майстерданих каналу, а не технологічної змінної  

`MODNMB` - номер модулю в пристроях, острову або шасі, де знаходиться канал	

`CH` - номер каналу в модулі, відповідно до нумерації модуля	

`SUBTYPE` - підтип каналу, за яким буде формуватися CLSID; CLSID для каналу визначається за полем `TYPE` та `SUBTYPE` за вказаними на листі `CLSID` ідентифікаторами  

`DEV` - назва пристрою або острову або шасі, де знаходиться модуль з каналом  (не обов'язкове)		 

`MODNM` - символьне ім'я модуля на пристрої шасі або острові (не обов'язкове)

`MODID` - повна символьна назва модуля в системі, може формуватися за назвою `DEV` + `MODNM` + `MODNMB`  (не обов'язкове)

### Поля для ВМ	 	

`ACTTR` - назва ВМ або іншого комплексного засобу, в якому використовується змінна (тільки за використання змінної у ВМ)	

`ACTTYPE` - назва типу ВМ або іншого комплексного засобу, в якому використовується змінна (тільки за використання змінної у ВМ)		

`TOPN` - час спрацювання для ВМ (не обов'язкове)	



